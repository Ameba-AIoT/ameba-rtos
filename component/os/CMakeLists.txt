if(CONFIG_KERNEL)
    if(CONFIG_PLATFORM_FREERTOS_ROM)
        ameba_add_subdirectory(freertos/freertos_rom)
    else()
        ameba_add_subdirectory(freertos)
    endif()
    if(${c_CURRENT_IMAGE_TYPE} STREQUAL "image2")
        ameba_add_subdirectory(freertos/os_wrapper)
        if(NOT CONFIG_PLATFORM_FREERTOS_ROM)
            if (CONFIG_WHC_HOST OR CONFIG_WHC_NONE)
                ameba_add_subdirectory(freertos/freertos_posix)
            endif()
        endif()
    endif()
endif()
